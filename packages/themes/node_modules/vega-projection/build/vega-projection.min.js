!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vega-scale")):"function"==typeof define&&define.amd?define(["exports","vega-scale"],t):t((n="undefined"!=typeof globalThis?globalThis:n||self).vega={},n.vega)}(this,(function(n,t){"use strict";class r{constructor(){this._partials=new Float64Array(32),this._n=0}add(n){const t=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const e=t[i],o=n+e,u=Math.abs(n)<Math.abs(e)?n-(o-e):e-(o-n);u&&(t[r++]=u),n=o}return t[r]=n,this._n=r+1,this}valueOf(){const n=this._partials;let t,r,i,e=this._n,o=0;if(e>0){for(o=n[--e];e>0&&(t=o,r=n[--e],o=t+r,i=r-(o-t),!i););e>0&&(i<0&&n[e-1]<0||i>0&&n[e-1]>0)&&(r=2*i,t=o+r,r==t-o&&(o=t))}return o}}function i(n){return Array.from(function*(n){for(const t of n)yield*t}(n))}var e=1e-6,o=Math.PI,u=o/2,a=o/4,l=2*o,c=180/o,f=o/180,s=Math.abs,p=Math.atan,h=Math.atan2,v=Math.cos,g=Math.exp,d=Math.log,E=Math.pow,S=Math.sin,y=Math.sign||function(n){return n>0?1:n<0?-1:0},m=Math.sqrt,_=Math.tan;function M(n){return n>1?0:n<-1?o:Math.acos(n)}function x(n){return n>1?u:n<-1?-u:Math.asin(n)}function w(){}function N(n,t){n&&$.hasOwnProperty(n.type)&&$[n.type](n,t)}var b={Feature:function(n,t){N(n.geometry,t)},FeatureCollection:function(n,t){for(var r=n.features,i=-1,e=r.length;++i<e;)N(r[i].geometry,t)}},$={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var r=n.coordinates,i=-1,e=r.length;++i<e;)n=r[i],t.point(n[0],n[1],n[2])},LineString:function(n,t){P(n.coordinates,t,0)},MultiLineString:function(n,t){for(var r=n.coordinates,i=-1,e=r.length;++i<e;)P(r[i],t,0)},Polygon:function(n,t){j(n.coordinates,t)},MultiPolygon:function(n,t){for(var r=n.coordinates,i=-1,e=r.length;++i<e;)j(r[i],t)},GeometryCollection:function(n,t){for(var r=n.geometries,i=-1,e=r.length;++i<e;)N(r[i],t)}};function P(n,t,r){var i,e=-1,o=n.length-r;for(t.lineStart();++e<o;)i=n[e],t.point(i[0],i[1],i[2]);t.lineEnd()}function j(n,t){var r=-1,i=n.length;for(t.polygonStart();++r<i;)P(n[r],t,1);t.polygonEnd()}function z(n,t){n&&b.hasOwnProperty(n.type)?b[n.type](n,t):N(n,t)}function R(n){return[h(n[1],n[0]),x(n[2])]}function q(n){var t=n[0],r=n[1],i=v(r);return[i*v(t),i*S(t),S(r)]}function A(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function T(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function k(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function L(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function C(n){var t=m(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function F(n,t){function r(r,i){return r=n(r,i),t(r[0],r[1])}return n.invert&&t.invert&&(r.invert=function(r,i){return(r=t.invert(r,i))&&n.invert(r[0],r[1])}),r}function H(n,t){return s(n)>o&&(n-=Math.round(n/l)*l),[n,t]}function O(n,t,r){return(n%=l)?t||r?F(X(n),Y(t,r)):X(n):t||r?Y(t,r):H}function W(n){return function(t,r){return s(t+=n)>o&&(t-=Math.round(t/l)*l),[t,r]}}function X(n){var t=W(n);return t.invert=W(-n),t}function Y(n,t){var r=v(n),i=S(n),e=v(t),o=S(t);function u(n,t){var u=v(t),a=v(n)*u,l=S(n)*u,c=S(t),f=c*r+a*i;return[h(l*e-f*o,a*r-c*i),x(f*e+l*o)]}return u.invert=function(n,t){var u=v(t),a=v(n)*u,l=S(n)*u,c=S(t),f=c*e-l*o;return[h(l*e+c*o,a*r+f*i),x(f*r-a*i)]},u}function I(n,t){(t=q(t))[0]-=n,C(t);var r=M(-t[1]);return((-t[2]<0?-r:r)+l-e)%l}function G(){var n,t=[];return{point:function(t,r,i){n.push([t,r,i])},lineStart:function(){t.push(n=[])},lineEnd:w,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var r=t;return t=[],n=null,r}}}function Z(n,t){return s(n[0]-t[0])<e&&s(n[1]-t[1])<e}function B(n,t,r,i){this.x=n,this.z=t,this.o=r,this.e=i,this.v=!1,this.n=this.p=null}function D(n,t,r,i,o){var u,a,l=[],c=[];if(n.forEach((function(n){if(!((t=n.length-1)<=0)){var t,r,i=n[0],a=n[t];if(Z(i,a)){if(!i[2]&&!a[2]){for(o.lineStart(),u=0;u<t;++u)o.point((i=n[u])[0],i[1]);return void o.lineEnd()}a[0]+=2*e}l.push(r=new B(i,n,null,!0)),c.push(r.o=new B(i,null,r,!1)),l.push(r=new B(a,n,null,!1)),c.push(r.o=new B(a,null,r,!0))}})),l.length){for(c.sort(t),J(l),J(c),u=0,a=c.length;u<a;++u)c[u].e=r=!r;for(var f,s,p=l[0];;){for(var h=p,v=!0;h.v;)if((h=h.n)===p)return;f=h.z,o.lineStart();do{if(h.v=h.o.v=!0,h.e){if(v)for(u=0,a=f.length;u<a;++u)o.point((s=f[u])[0],s[1]);else i(h.x,h.n.x,1,o);h=h.n}else{if(v)for(f=h.p.z,u=f.length-1;u>=0;--u)o.point((s=f[u])[0],s[1]);else i(h.x,h.p.x,-1,o);h=h.p}f=(h=h.o).z,v=!v}while(!h.v);o.lineEnd()}}}function J(n){if(t=n.length){for(var t,r,i=0,e=n[0];++i<t;)e.n=r=n[i],r.p=e,e=r;e.n=r=n[0],r.p=e}}function K(n){return s(n[0])<=o?n[0]:y(n[0])*((s(n[0])+o)%l-o)}function Q(n,t,c,f){return function(s){var p,g,d,E=t(s),y=G(),m=t(y),_=!1,M={point:w,lineStart:b,lineEnd:$,polygonStart:function(){M.point=P,M.lineStart=j,M.lineEnd=z,g=[],p=[]},polygonEnd:function(){M.point=w,M.lineStart=b,M.lineEnd=$,g=i(g);var n=function(n,t){var i=K(t),c=t[1],f=S(c),s=[S(i),-v(i),0],p=0,g=0,d=new r;1===f?c=u+e:-1===f&&(c=-u-e);for(var E=0,y=n.length;E<y;++E)if(_=(m=n[E]).length)for(var m,_,M=m[_-1],w=K(M),N=M[1]/2+a,b=S(N),$=v(N),P=0;P<_;++P,w=z,b=A,$=k,M=j){var j=m[P],z=K(j),R=j[1]/2+a,A=S(R),k=v(R),L=z-w,F=L>=0?1:-1,H=F*L,O=H>o,W=b*A;if(d.add(h(W*F*S(H),$*k+W*v(H))),p+=O?L+F*l:L,O^w>=i^z>=i){var X=T(q(M),q(j));C(X);var Y=T(s,X);C(Y);var I=(O^L>=0?-1:1)*x(Y[2]);(c>I||c===I&&(X[0]||X[1]))&&(g+=O^L>=0?1:-1)}}return(p<-1e-6||p<e&&d<-1e-12)^1&g}(p,f);g.length?(_||(s.polygonStart(),_=!0),D(g,V,n,c,s)):n&&(_||(s.polygonStart(),_=!0),s.lineStart(),c(null,null,1,s),s.lineEnd()),_&&(s.polygonEnd(),_=!1),g=p=null},sphere:function(){s.polygonStart(),s.lineStart(),c(null,null,1,s),s.lineEnd(),s.polygonEnd()}};function w(t,r){n(t,r)&&s.point(t,r)}function N(n,t){E.point(n,t)}function b(){M.point=N,E.lineStart()}function $(){M.point=w,E.lineEnd()}function P(n,t){d.push([n,t]),m.point(n,t)}function j(){m.lineStart(),d=[]}function z(){P(d[0][0],d[0][1]),m.lineEnd();var n,t,r,i,e=m.clean(),o=y.result(),u=o.length;if(d.pop(),p.push(d),d=null,u)if(1&e){if((t=(r=o[0]).length-1)>0){for(_||(s.polygonStart(),_=!0),s.lineStart(),n=0;n<t;++n)s.point((i=r[n])[0],i[1]);s.lineEnd()}}else u>1&&2&e&&o.push(o.pop().concat(o.shift())),g.push(o.filter(U))}return M}}function U(n){return n.length>1}function V(n,t){return((n=n.x)[0]<0?n[1]-u-e:u-n[1])-((t=t.x)[0]<0?t[1]-u-e:u-t[1])}H.invert=H;var nn=Q((function(){return!0}),(function(n){var t,r=NaN,i=NaN,a=NaN;return{lineStart:function(){n.lineStart(),t=1},point:function(l,c){var f=l>0?o:-o,h=s(l-r);s(h-o)<e?(n.point(r,i=(i+c)/2>0?u:-u),n.point(a,i),n.lineEnd(),n.lineStart(),n.point(f,i),n.point(l,i),t=0):a!==f&&h>=o&&(s(r-a)<e&&(r-=a*e),s(l-f)<e&&(l-=f*e),i=function(n,t,r,i){var o,u,a=S(n-r);return s(a)>e?p((S(t)*(u=v(i))*S(r)-S(i)*(o=v(t))*S(n))/(o*u*a)):(t+i)/2}(r,i,l,c),n.point(a,i),n.lineEnd(),n.lineStart(),n.point(f,i),t=0),n.point(r=l,i=c),a=f},lineEnd:function(){n.lineEnd(),r=i=NaN},clean:function(){return 2-t}}}),(function(n,t,r,i){var a;if(null==n)a=r*u,i.point(-o,a),i.point(0,a),i.point(o,a),i.point(o,0),i.point(o,-a),i.point(0,-a),i.point(-o,-a),i.point(-o,0),i.point(-o,a);else if(s(n[0]-t[0])>e){var l=n[0]<t[0]?o:-o;a=r*l/2,i.point(-l,a),i.point(0,a),i.point(l,a)}else i.point(t[0],t[1])}),[-o,-u]);function tn(n){var t=v(n),r=6*f,i=t>0,u=s(t)>e;function a(n,r){return v(n)*v(r)>t}function c(n,r,i){var u=[1,0,0],a=T(q(n),q(r)),l=A(a,a),c=a[0],f=l-c*c;if(!f)return!i&&n;var p=t*l/f,h=-t*c/f,v=T(u,a),g=L(u,p);k(g,L(a,h));var d=v,E=A(g,d),S=A(d,d),y=E*E-S*(A(g,g)-1);if(!(y<0)){var _=m(y),M=L(d,(-E-_)/S);if(k(M,g),M=R(M),!i)return M;var x,w=n[0],N=r[0],b=n[1],$=r[1];N<w&&(x=w,w=N,N=x);var P=N-w,j=s(P-o)<e;if(!j&&$<b&&(x=b,b=$,$=x),j||P<e?j?b+$>0^M[1]<(s(M[0]-w)<e?b:$):b<=M[1]&&M[1]<=$:P>o^(w<=M[0]&&M[0]<=N)){var z=L(d,(-E+_)/S);return k(z,g),[M,R(z)]}}}function p(t,r){var e=i?n:o-n,u=0;return t<-e?u|=1:t>e&&(u|=2),r<-e?u|=4:r>e&&(u|=8),u}return Q(a,(function(n){var t,r,e,l,f;return{lineStart:function(){l=e=!1,f=1},point:function(s,h){var v,g=[s,h],d=a(s,h),E=i?d?0:p(s,h):d?p(s+(s<0?o:-o),h):0;if(!t&&(l=e=d)&&n.lineStart(),d!==e&&(!(v=c(t,g))||Z(t,v)||Z(g,v))&&(g[2]=1),d!==e)f=0,d?(n.lineStart(),v=c(g,t),n.point(v[0],v[1])):(v=c(t,g),n.point(v[0],v[1],2),n.lineEnd()),t=v;else if(u&&t&&i^d){var S;E&r||!(S=c(g,t,!0))||(f=0,i?(n.lineStart(),n.point(S[0][0],S[0][1]),n.point(S[1][0],S[1][1]),n.lineEnd()):(n.point(S[1][0],S[1][1]),n.lineEnd(),n.lineStart(),n.point(S[0][0],S[0][1],3)))}!d||t&&Z(t,g)||n.point(g[0],g[1]),t=g,e=d,r=E},lineEnd:function(){e&&n.lineEnd(),t=null},clean:function(){return f|(l&&e)<<1}}}),(function(t,i,e,o){!function(n,t,r,i,e,o){if(r){var u=v(t),a=S(t),c=i*r;null==e?(e=t+i*l,o=t-c/2):(e=I(u,e),o=I(u,o),(i>0?e<o:e>o)&&(e+=i*l));for(var f,s=e;i>0?s>o:s<o;s-=c)f=R([u,-a*v(s),-a*S(s)]),n.point(f[0],f[1])}}(o,n,r,e,t,i)}),i?[0,-n]:[-o,n-o])}var rn=1e9,en=-1e9;function on(n,t,r,o){function u(i,e){return n<=i&&i<=r&&t<=e&&e<=o}function a(i,e,u,a){var c=0,s=0;if(null==i||(c=l(i,u))!==(s=l(e,u))||f(i,e)<0^u>0)do{a.point(0===c||3===c?n:r,c>1?o:t)}while((c=(c+u+4)%4)!==s);else a.point(e[0],e[1])}function l(i,o){return s(i[0]-n)<e?o>0?0:3:s(i[0]-r)<e?o>0?2:1:s(i[1]-t)<e?o>0?1:0:o>0?3:2}function c(n,t){return f(n.x,t.x)}function f(n,t){var r=l(n,1),i=l(t,1);return r!==i?r-i:0===r?t[1]-n[1]:1===r?n[0]-t[0]:2===r?n[1]-t[1]:t[0]-n[0]}return function(e){var l,f,s,p,h,v,g,d,E,S,y,m=e,_=G(),M={point:x,lineStart:function(){M.point=w,f&&f.push(s=[]);S=!0,E=!1,g=d=NaN},lineEnd:function(){l&&(w(p,h),v&&E&&_.rejoin(),l.push(_.result()));M.point=x,E&&m.lineEnd()},polygonStart:function(){m=_,l=[],f=[],y=!0},polygonEnd:function(){var t=function(){for(var t=0,r=0,i=f.length;r<i;++r)for(var e,u,a=f[r],l=1,c=a.length,s=a[0],p=s[0],h=s[1];l<c;++l)e=p,u=h,p=(s=a[l])[0],h=s[1],u<=o?h>o&&(p-e)*(o-u)>(h-u)*(n-e)&&++t:h<=o&&(p-e)*(o-u)<(h-u)*(n-e)&&--t;return t}(),r=y&&t,u=(l=i(l)).length;(r||u)&&(e.polygonStart(),r&&(e.lineStart(),a(null,null,1,e),e.lineEnd()),u&&D(l,c,t,a,e),e.polygonEnd());m=e,l=f=s=null}};function x(n,t){u(n,t)&&m.point(n,t)}function w(i,e){var a=u(i,e);if(f&&s.push([i,e]),S)p=i,h=e,v=a,S=!1,a&&(m.lineStart(),m.point(i,e));else if(a&&E)m.point(i,e);else{var l=[g=Math.max(en,Math.min(rn,g)),d=Math.max(en,Math.min(rn,d))],c=[i=Math.max(en,Math.min(rn,i)),e=Math.max(en,Math.min(rn,e))];!function(n,t,r,i,e,o){var u,a=n[0],l=n[1],c=0,f=1,s=t[0]-a,p=t[1]-l;if(u=r-a,s||!(u>0)){if(u/=s,s<0){if(u<c)return;u<f&&(f=u)}else if(s>0){if(u>f)return;u>c&&(c=u)}if(u=e-a,s||!(u<0)){if(u/=s,s<0){if(u>f)return;u>c&&(c=u)}else if(s>0){if(u<c)return;u<f&&(f=u)}if(u=i-l,p||!(u>0)){if(u/=p,p<0){if(u<c)return;u<f&&(f=u)}else if(p>0){if(u>f)return;u>c&&(c=u)}if(u=o-l,p||!(u<0)){if(u/=p,p<0){if(u>f)return;u>c&&(c=u)}else if(p>0){if(u<c)return;u<f&&(f=u)}return c>0&&(n[0]=a+c*s,n[1]=l+c*p),f<1&&(t[0]=a+f*s,t[1]=l+f*p),!0}}}}}(l,c,n,t,r,o)?a&&(m.lineStart(),m.point(i,e),y=!1):(E||(m.lineStart(),m.point(l[0],l[1])),m.point(c[0],c[1]),a||m.lineEnd(),y=!1)}g=i,d=e,E=a}return M}}var un,an,ln,cn,fn=n=>n,sn=new r,pn=new r,hn={point:w,lineStart:w,lineEnd:w,polygonStart:function(){hn.lineStart=vn,hn.lineEnd=En},polygonEnd:function(){hn.lineStart=hn.lineEnd=hn.point=w,sn.add(s(pn)),pn=new r},result:function(){var n=sn/2;return sn=new r,n}};function vn(){hn.point=gn}function gn(n,t){hn.point=dn,un=ln=n,an=cn=t}function dn(n,t){pn.add(cn*n-ln*t),ln=n,cn=t}function En(){dn(un,an)}var Sn=1/0,yn=Sn,mn=-Sn,_n=mn,Mn={point:function(n,t){n<Sn&&(Sn=n);n>mn&&(mn=n);t<yn&&(yn=t);t>_n&&(_n=t)},lineStart:w,lineEnd:w,polygonStart:w,polygonEnd:w,result:function(){var n=[[Sn,yn],[mn,_n]];return mn=_n=-(yn=Sn=1/0),n}};var xn,wn,Nn,bn,$n=0,Pn=0,jn=0,zn=0,Rn=0,qn=0,An=0,Tn=0,kn=0,Ln={point:Cn,lineStart:Fn,lineEnd:Wn,polygonStart:function(){Ln.lineStart=Xn,Ln.lineEnd=Yn},polygonEnd:function(){Ln.point=Cn,Ln.lineStart=Fn,Ln.lineEnd=Wn},result:function(){var n=kn?[An/kn,Tn/kn]:qn?[zn/qn,Rn/qn]:jn?[$n/jn,Pn/jn]:[NaN,NaN];return $n=Pn=jn=zn=Rn=qn=An=Tn=kn=0,n}};function Cn(n,t){$n+=n,Pn+=t,++jn}function Fn(){Ln.point=Hn}function Hn(n,t){Ln.point=On,Cn(Nn=n,bn=t)}function On(n,t){var r=n-Nn,i=t-bn,e=m(r*r+i*i);zn+=e*(Nn+n)/2,Rn+=e*(bn+t)/2,qn+=e,Cn(Nn=n,bn=t)}function Wn(){Ln.point=Cn}function Xn(){Ln.point=In}function Yn(){Gn(xn,wn)}function In(n,t){Ln.point=Gn,Cn(xn=Nn=n,wn=bn=t)}function Gn(n,t){var r=n-Nn,i=t-bn,e=m(r*r+i*i);zn+=e*(Nn+n)/2,Rn+=e*(bn+t)/2,qn+=e,An+=(e=bn*n-Nn*t)*(Nn+n),Tn+=e*(bn+t),kn+=3*e,Cn(Nn=n,bn=t)}function Zn(n){this._context=n}Zn.prototype={_radius:4.5,pointRadius:function(n){return this._radius=n,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(n,t){switch(this._point){case 0:this._context.moveTo(n,t),this._point=1;break;case 1:this._context.lineTo(n,t);break;default:this._context.moveTo(n+this._radius,t),this._context.arc(n,t,this._radius,0,l)}},result:w};var Bn,Dn,Jn,Kn,Qn,Un=new r,Vn={point:w,lineStart:function(){Vn.point=nt},lineEnd:function(){Bn&&tt(Dn,Jn),Vn.point=w},polygonStart:function(){Bn=!0},polygonEnd:function(){Bn=null},result:function(){var n=+Un;return Un=new r,n}};function nt(n,t){Vn.point=tt,Dn=Kn=n,Jn=Qn=t}function tt(n,t){Kn-=n,Qn-=t,Un.add(m(Kn*Kn+Qn*Qn)),Kn=n,Qn=t}let rt,it,et,ot;class ut{constructor(n){this._append=null==n?at:function(n){const t=Math.floor(n);if(!(t>=0))throw new RangeError(`invalid digits: ${n}`);if(t>15)return at;if(t!==rt){const n=10**t;rt=t,it=function(t){let r=1;this._+=t[0];for(const i=t.length;r<i;++r)this._+=Math.round(arguments[r]*n)/n+t[r]}}return it}(n),this._radius=4.5,this._=""}pointRadius(n){return this._radius=+n,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){0===this._line&&(this._+="Z"),this._point=NaN}point(n,t){switch(this._point){case 0:this._append`M${n},${t}`,this._point=1;break;case 1:this._append`L${n},${t}`;break;default:if(this._append`M${n},${t}`,this._radius!==et||this._append!==it){const n=this._radius,t=this._;this._="",this._append`m0,${n}a${n},${n} 0 1,1 0,${-2*n}a${n},${n} 0 1,1 0,${2*n}z`,et=n,it=this._append,ot=this._,this._=t}this._+=ot}}result(){const n=this._;return this._="",n.length?n:null}}function at(n){let t=1;this._+=n[0];for(const r=n.length;t<r;++t)this._+=arguments[t]+n[t]}function lt(n,t){let r,i,e=3,o=4.5;function u(n){return n&&("function"==typeof o&&i.pointRadius(+o.apply(this,arguments)),z(n,r(i))),i.result()}return u.area=function(n){return z(n,r(hn)),hn.result()},u.measure=function(n){return z(n,r(Vn)),Vn.result()},u.bounds=function(n){return z(n,r(Mn)),Mn.result()},u.centroid=function(n){return z(n,r(Ln)),Ln.result()},u.projection=function(t){return arguments.length?(r=null==t?(n=null,fn):(n=t).stream,u):n},u.context=function(n){return arguments.length?(i=null==n?(t=null,new ut(e)):new Zn(t=n),"function"!=typeof o&&i.pointRadius(o),u):t},u.pointRadius=function(n){return arguments.length?(o="function"==typeof n?n:(i.pointRadius(+n),+n),u):o},u.digits=function(n){if(!arguments.length)return e;if(null==n)e=null;else{const t=Math.floor(n);if(!(t>=0))throw new RangeError(`invalid digits: ${n}`);e=t}return null===t&&(i=new ut(e)),u},u.projection(n).digits(e).context(t)}function ct(n){return function(t){var r=new ft;for(var i in n)r[i]=n[i];return r.stream=t,r}}function ft(){}function st(n,t,r){var i=n.clipExtent&&n.clipExtent();return n.scale(150).translate([0,0]),null!=i&&n.clipExtent(null),z(r,n.stream(Mn)),t(Mn.result()),null!=i&&n.clipExtent(i),n}function pt(n,t,r){return st(n,(function(r){var i=t[1][0]-t[0][0],e=t[1][1]-t[0][1],o=Math.min(i/(r[1][0]-r[0][0]),e/(r[1][1]-r[0][1])),u=+t[0][0]+(i-o*(r[1][0]+r[0][0]))/2,a=+t[0][1]+(e-o*(r[1][1]+r[0][1]))/2;n.scale(150*o).translate([u,a])}),r)}function ht(n,t,r){return pt(n,[[0,0],t],r)}function vt(n,t,r){return st(n,(function(r){var i=+t,e=i/(r[1][0]-r[0][0]),o=(i-e*(r[1][0]+r[0][0]))/2,u=-e*r[0][1];n.scale(150*e).translate([o,u])}),r)}function gt(n,t,r){return st(n,(function(r){var i=+t,e=i/(r[1][1]-r[0][1]),o=-e*r[0][0],u=(i-e*(r[1][1]+r[0][1]))/2;n.scale(150*e).translate([o,u])}),r)}ft.prototype={constructor:ft,point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var dt=16,Et=v(30*f);function St(n,t){return+t?function(n,t){function r(i,o,u,a,l,c,f,p,v,g,d,E,S,y){var _=f-i,M=p-o,w=_*_+M*M;if(w>4*t&&S--){var N=a+g,b=l+d,$=c+E,P=m(N*N+b*b+$*$),j=x($/=P),z=s(s($)-1)<e||s(u-v)<e?(u+v)/2:h(b,N),R=n(z,j),q=R[0],A=R[1],T=q-i,k=A-o,L=M*T-_*k;(L*L/w>t||s((_*T+M*k)/w-.5)>.3||a*g+l*d+c*E<Et)&&(r(i,o,u,a,l,c,q,A,z,N/=P,b/=P,$,S,y),y.point(q,A),r(q,A,z,N,b,$,f,p,v,g,d,E,S,y))}}return function(t){var i,e,o,u,a,l,c,f,s,p,h,v,g={point:d,lineStart:E,lineEnd:y,polygonStart:function(){t.polygonStart(),g.lineStart=m},polygonEnd:function(){t.polygonEnd(),g.lineStart=E}};function d(r,i){r=n(r,i),t.point(r[0],r[1])}function E(){f=NaN,g.point=S,t.lineStart()}function S(i,e){var o=q([i,e]),u=n(i,e);r(f,s,c,p,h,v,f=u[0],s=u[1],c=i,p=o[0],h=o[1],v=o[2],dt,t),t.point(f,s)}function y(){g.point=d,t.lineEnd()}function m(){E(),g.point=_,g.lineEnd=M}function _(n,t){S(i=n,t),e=f,o=s,u=p,a=h,l=v,g.point=S}function M(){r(f,s,c,p,h,v,e,o,i,u,a,l,dt,t),g.lineEnd=y,y()}return g}}(n,t):function(n){return ct({point:function(t,r){t=n(t,r),this.stream.point(t[0],t[1])}})}(n)}var yt=ct({point:function(n,t){this.stream.point(n*f,t*f)}});function mt(n,t,r,i,e,o){if(!o)return function(n,t,r,i,e){function o(o,u){return[t+n*(o*=i),r-n*(u*=e)]}return o.invert=function(o,u){return[(o-t)/n*i,(r-u)/n*e]},o}(n,t,r,i,e);var u=v(o),a=S(o),l=u*n,c=a*n,f=u/n,s=a/n,p=(a*r-u*t)/n,h=(a*t+u*r)/n;function g(n,o){return[l*(n*=i)-c*(o*=e)+t,r-c*n-l*o]}return g.invert=function(n,t){return[i*(f*n-s*t+p),e*(h-s*n-f*t)]},g}function _t(n){return Mt((function(){return n}))()}function Mt(n){var t,r,i,e,o,u,a,l,s,p,h=150,v=480,g=250,d=0,E=0,S=0,y=0,_=0,M=0,x=1,w=1,N=null,b=nn,$=null,P=fn,j=.5;function z(n){return l(n[0]*f,n[1]*f)}function R(n){return(n=l.invert(n[0],n[1]))&&[n[0]*c,n[1]*c]}function q(){var n=mt(h,0,0,x,w,M).apply(null,t(d,E)),i=mt(h,v-n[0],g-n[1],x,w,M);return r=O(S,y,_),a=F(t,i),l=F(r,a),u=St(a,j),A()}function A(){return s=p=null,z}return z.stream=function(n){return s&&p===n?s:s=yt(function(n){return ct({point:function(t,r){var i=n(t,r);return this.stream.point(i[0],i[1])}})}(r)(b(u(P(p=n)))))},z.preclip=function(n){return arguments.length?(b=n,N=void 0,A()):b},z.postclip=function(n){return arguments.length?(P=n,$=i=e=o=null,A()):P},z.clipAngle=function(n){return arguments.length?(b=+n?tn(N=n*f):(N=null,nn),A()):N*c},z.clipExtent=function(n){return arguments.length?(P=null==n?($=i=e=o=null,fn):on($=+n[0][0],i=+n[0][1],e=+n[1][0],o=+n[1][1]),A()):null==$?null:[[$,i],[e,o]]},z.scale=function(n){return arguments.length?(h=+n,q()):h},z.translate=function(n){return arguments.length?(v=+n[0],g=+n[1],q()):[v,g]},z.center=function(n){return arguments.length?(d=n[0]%360*f,E=n[1]%360*f,q()):[d*c,E*c]},z.rotate=function(n){return arguments.length?(S=n[0]%360*f,y=n[1]%360*f,_=n.length>2?n[2]%360*f:0,q()):[S*c,y*c,_*c]},z.angle=function(n){return arguments.length?(M=n%360*f,q()):M*c},z.reflectX=function(n){return arguments.length?(x=n?-1:1,q()):x<0},z.reflectY=function(n){return arguments.length?(w=n?-1:1,q()):w<0},z.precision=function(n){return arguments.length?(u=St(a,j=n*n),A()):m(j)},z.fitExtent=function(n,t){return pt(z,n,t)},z.fitSize=function(n,t){return ht(z,n,t)},z.fitWidth=function(n,t){return vt(z,n,t)},z.fitHeight=function(n,t){return gt(z,n,t)},function(){return t=n.apply(this,arguments),z.invert=t.invert&&R,q()}}function xt(n){var t=0,r=o/3,i=Mt(n),e=i(t,r);return e.parallels=function(n){return arguments.length?i(t=n[0]*f,r=n[1]*f):[t*c,r*c]},e}function wt(n,t){var r=S(n),i=(r+S(t))/2;if(s(i)<e)return function(n){var t=v(n);function r(n,r){return[n*t,S(r)/t]}return r.invert=function(n,r){return[n/t,x(r*t)]},r}(n);var u=1+r*(2*i-r),a=m(u)/i;function l(n,t){var r=m(u-2*i*S(t))/i;return[r*S(n*=i),a-r*v(n)]}return l.invert=function(n,t){var r=a-t,e=h(n,s(r))*y(r);return r*i<0&&(e-=o*y(n)*y(r)),[e/i,x((u-(n*n+r*r)*i*i)/(2*i))]},l}function Nt(){return xt(wt).scale(155.424).center([0,33.6442])}function bt(){return Nt().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function $t(n){return function(t,r){var i=v(t),e=v(r),o=n(i*e);return o===1/0?[2,0]:[o*e*S(t),o*S(r)]}}function Pt(n){return function(t,r){var i=m(t*t+r*r),e=n(i),o=S(e),u=v(e);return[h(t*o,i*u),x(i&&r*o/i)]}}var jt=$t((function(n){return m(2/(1+n))}));jt.invert=Pt((function(n){return 2*x(n/2)}));var zt=$t((function(n){return(n=M(n))&&n/S(n)}));function Rt(n,t){return[n,d(_((u+t)/2))]}function qt(n){var t,r,i,e=_t(n),u=e.center,a=e.scale,l=e.translate,s=e.clipExtent,p=null;function h(){var u=o*a(),l=e(function(n){function t(t){return(t=n(t[0]*f,t[1]*f))[0]*=c,t[1]*=c,t}return n=O(n[0]*f,n[1]*f,n.length>2?n[2]*f:0),t.invert=function(t){return(t=n.invert(t[0]*f,t[1]*f))[0]*=c,t[1]*=c,t},t}(e.rotate()).invert([0,0]));return s(null==p?[[l[0]-u,l[1]-u],[l[0]+u,l[1]+u]]:n===Rt?[[Math.max(l[0]-u,p),t],[Math.min(l[0]+u,r),i]]:[[p,Math.max(l[1]-u,t)],[r,Math.min(l[1]+u,i)]])}return e.scale=function(n){return arguments.length?(a(n),h()):a()},e.translate=function(n){return arguments.length?(l(n),h()):l()},e.center=function(n){return arguments.length?(u(n),h()):u()},e.clipExtent=function(n){return arguments.length?(null==n?p=t=r=i=null:(p=+n[0][0],t=+n[0][1],r=+n[1][0],i=+n[1][1]),h()):null==p?null:[[p,t],[r,i]]},h()}function At(n){return _((u+n)/2)}function Tt(n,t){var r=v(n),i=n===t?S(n):d(r/v(t))/d(At(t)/At(n)),a=r*E(At(n),i)/i;if(!i)return Rt;function l(n,t){a>0?t<-u+e&&(t=-u+e):t>u-e&&(t=u-e);var r=a/E(At(t),i);return[r*S(i*n),a-r*v(i*n)]}return l.invert=function(n,t){var r=a-t,e=y(i)*m(n*n+r*r),l=h(n,s(r))*y(r);return r*i<0&&(l-=o*y(n)*y(r)),[l/i,2*p(E(a/e,1/i))-u]},l}function kt(n,t){return[n,t]}function Lt(n,t){var r=v(n),i=n===t?S(n):(r-v(t))/(t-n),u=r/i+n;if(s(i)<e)return kt;function a(n,t){var r=u-t,e=i*n;return[r*S(e),u-r*v(e)]}return a.invert=function(n,t){var r=u-t,e=h(n,s(r))*y(r);return r*i<0&&(e-=o*y(n)*y(r)),[e/i,u-y(i)*m(n*n+r*r)]},a}zt.invert=Pt((function(n){return n})),Rt.invert=function(n,t){return[n,2*p(g(t))-u]},kt.invert=kt;var Ct=1.340264,Ft=-.081106,Ht=893e-6,Ot=.003796,Wt=m(3)/2;function Xt(n,t){var r=x(Wt*S(t)),i=r*r,e=i*i*i;return[n*v(r)/(Wt*(Ct+3*Ft*i+e*(7*Ht+9*Ot*i))),r*(Ct+Ft*i+e*(Ht+Ot*i))]}function Yt(n,t){var r=v(t),i=v(n)*r;return[r*S(n)/i,S(t)/i]}function It(n,t){var r=t*t,i=r*r;return[n*(.8707-.131979*r+i*(i*(.003971*r-.001529*i)-.013791)),t*(1.007226+r*(.015085+i*(.028874*r-.044475-.005916*i)))]}function Gt(n,t){return[v(t)*S(n),S(t)]}function Zt(n,t){var r=v(t),i=1+v(n)*r;return[r*S(n)/i,S(t)/i]}function Bt(n,t){return[d(_((u+t)/2)),-n]}Xt.invert=function(n,t){for(var r,i=t,e=i*i,o=e*e*e,u=0;u<12&&(o=(e=(i-=r=(i*(Ct+Ft*e+o*(Ht+Ot*e))-t)/(Ct+3*Ft*e+o*(7*Ht+9*Ot*e)))*i)*e*e,!(s(r)<1e-12));++u);return[Wt*n*(Ct+3*Ft*e+o*(7*Ht+9*Ot*e))/v(i),x(S(i)/Wt)]},Yt.invert=Pt(p),It.invert=function(n,t){var r,i=t,o=25;do{var u=i*i,a=u*u;i-=r=(i*(1.007226+u*(.015085+a*(.028874*u-.044475-.005916*a)))-t)/(1.007226+u*(.045255+a*(.259866*u-.311325-.005916*11*a)))}while(s(r)>e&&--o>0);return[n/(.8707+(u=i*i)*(u*(u*u*u*(.003971-.001529*u)-.013791)-.131979)),i]},Gt.invert=Pt(x),Zt.invert=Pt((function(n){return 2*p(n)})),Bt.invert=function(n,t){return[-t,2*p(g(n))-u]};var Dt,Jt=Math.abs,Kt=Math.cos,Qt=Math.sin,Ut=1e-6,Vt=Math.PI,nr=Vt/2,tr=(Dt=2)>0?Math.sqrt(Dt):0;function rr(n){return n>1?nr:n<-1?-nr:Math.asin(n)}function ir(n,t){var r,i=n*Qt(t),e=30;do{t-=r=(t+Qt(t)-i)/(1+Kt(t))}while(Jt(r)>Ut&&--e>0);return t/2}var er=function(n,t,r){function i(i,e){return[n*i*Kt(e=ir(r,e)),t*Qt(e)]}return i.invert=function(i,e){return e=rr(e/t),[i/(n*Kt(e)),rr((2*e+Qt(2*e))/r)]},i}(tr/nr,tr,Vt);const or=lt(),ur=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function ar(n,r){if(!n||"string"!=typeof n)throw new Error("Projection type must be a name string.");return n=n.toLowerCase(),arguments.length>1?(lr[n]=function(n,r){return function i(){const e=r();return e.type=n,e.path=lt().projection(e),e.copy=e.copy||function(){const n=i();return ur.forEach((t=>{e[t]&&n[t](e[t]())})),n.path.pointRadius(e.path.pointRadius()),n},t.registerScale(e)}}(n,r),this):lr[n]||null}const lr={albers:bt,albersusa:function(){var n,t,r,i,o,u,a=bt(),l=Nt().rotate([154,0]).center([-2,58.5]).parallels([55,65]),c=Nt().rotate([157,0]).center([-3,19.9]).parallels([8,18]),f={point:function(n,t){u=[n,t]}};function s(n){var t=n[0],e=n[1];return u=null,r.point(t,e),u||(i.point(t,e),u)||(o.point(t,e),u)}function p(){return n=t=null,s}return s.invert=function(n){var t=a.scale(),r=a.translate(),i=(n[0]-r[0])/t,e=(n[1]-r[1])/t;return(e>=.12&&e<.234&&i>=-.425&&i<-.214?l:e>=.166&&e<.234&&i>=-.214&&i<-.115?c:a).invert(n)},s.stream=function(r){return n&&t===r?n:(i=[a.stream(t=r),l.stream(r),c.stream(r)],e=i.length,n={point:function(n,t){for(var r=-1;++r<e;)i[r].point(n,t)},sphere:function(){for(var n=-1;++n<e;)i[n].sphere()},lineStart:function(){for(var n=-1;++n<e;)i[n].lineStart()},lineEnd:function(){for(var n=-1;++n<e;)i[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<e;)i[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<e;)i[n].polygonEnd()}});var i,e},s.precision=function(n){return arguments.length?(a.precision(n),l.precision(n),c.precision(n),p()):a.precision()},s.scale=function(n){return arguments.length?(a.scale(n),l.scale(.35*n),c.scale(n),s.translate(a.translate())):a.scale()},s.translate=function(n){if(!arguments.length)return a.translate();var t=a.scale(),u=+n[0],s=+n[1];return r=a.translate(n).clipExtent([[u-.455*t,s-.238*t],[u+.455*t,s+.238*t]]).stream(f),i=l.translate([u-.307*t,s+.201*t]).clipExtent([[u-.425*t+e,s+.12*t+e],[u-.214*t-e,s+.234*t-e]]).stream(f),o=c.translate([u-.205*t,s+.212*t]).clipExtent([[u-.214*t+e,s+.166*t+e],[u-.115*t-e,s+.234*t-e]]).stream(f),p()},s.fitExtent=function(n,t){return pt(s,n,t)},s.fitSize=function(n,t){return ht(s,n,t)},s.fitWidth=function(n,t){return vt(s,n,t)},s.fitHeight=function(n,t){return gt(s,n,t)},s.scale(1070)},azimuthalequalarea:function(){return _t(jt).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return _t(zt).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return xt(Tt).scale(109.5).parallels([30,30])},conicequalarea:Nt,conicequidistant:function(){return xt(Lt).scale(131.154).center([0,13.9389])},equalEarth:function(){return _t(Xt).scale(177.158)},equirectangular:function(){return _t(kt).scale(152.63)},gnomonic:function(){return _t(Yt).scale(144.049).clipAngle(60)},identity:function(){var n,t,r,i,e,o,u,a=1,l=0,s=0,p=1,h=1,g=0,d=null,E=1,y=1,m=ct({point:function(n,t){var r=x([n,t]);this.stream.point(r[0],r[1])}}),_=fn;function M(){return E=a*p,y=a*h,o=u=null,x}function x(r){var i=r[0]*E,e=r[1]*y;if(g){var o=e*n-i*t;i=i*n+e*t,e=o}return[i+l,e+s]}return x.invert=function(r){var i=r[0]-l,e=r[1]-s;if(g){var o=e*n+i*t;i=i*n-e*t,e=o}return[i/E,e/y]},x.stream=function(n){return o&&u===n?o:o=m(_(u=n))},x.postclip=function(n){return arguments.length?(_=n,d=r=i=e=null,M()):_},x.clipExtent=function(n){return arguments.length?(_=null==n?(d=r=i=e=null,fn):on(d=+n[0][0],r=+n[0][1],i=+n[1][0],e=+n[1][1]),M()):null==d?null:[[d,r],[i,e]]},x.scale=function(n){return arguments.length?(a=+n,M()):a},x.translate=function(n){return arguments.length?(l=+n[0],s=+n[1],M()):[l,s]},x.angle=function(r){return arguments.length?(t=S(g=r%360*f),n=v(g),M()):g*c},x.reflectX=function(n){return arguments.length?(p=n?-1:1,M()):p<0},x.reflectY=function(n){return arguments.length?(h=n?-1:1,M()):h<0},x.fitExtent=function(n,t){return pt(x,n,t)},x.fitSize=function(n,t){return ht(x,n,t)},x.fitWidth=function(n,t){return vt(x,n,t)},x.fitHeight=function(n,t){return gt(x,n,t)},x},mercator:function(){return qt(Rt).scale(961/l)},mollweide:function(){return _t(er).scale(169.529)},naturalEarth1:function(){return _t(It).scale(175.295)},orthographic:function(){return _t(Gt).scale(249.5).clipAngle(90+e)},stereographic:function(){return _t(Zt).scale(250).clipAngle(142)},transversemercator:function(){var n=qt(Bt),t=n.center,r=n.rotate;return n.center=function(n){return arguments.length?t([-n[1],n[0]]):[(n=t())[1],-n[0]]},n.rotate=function(n){return arguments.length?r([n[0],n[1],n.length>2?n[2]+90:90]):[(n=r())[0],n[1],n[2]-90]},r([0,0,90]).scale(159.155)}};for(const n in lr)ar(n,lr[n]);n.getProjectionPath=function(n){return n&&n.path||or},n.projection=ar,n.projectionProperties=ur}));
//# sourceMappingURL=vega-projection.min.js.map
