<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Developer-Docs" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.0">
<title data-rh="true">Developer Docs | React Spectrum Charts</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://opensource.adobe.com/react-spectrum-charts/PR-596-docs/docs/Developer-Docs"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Developer Docs | React Spectrum Charts"><meta data-rh="true" name="description" content="What is react-spectrum-charts?"><meta data-rh="true" property="og:description" content="What is react-spectrum-charts?"><link data-rh="true" rel="icon" href="https://www.adobe.com/favicon.ico"><link data-rh="true" rel="canonical" href="https://opensource.adobe.com/react-spectrum-charts/PR-596-docs/docs/Developer-Docs"><link data-rh="true" rel="alternate" href="https://opensource.adobe.com/react-spectrum-charts/PR-596-docs/docs/Developer-Docs" hreflang="en"><link data-rh="true" rel="alternate" href="https://opensource.adobe.com/react-spectrum-charts/PR-596-docs/docs/Developer-Docs" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Developer Docs","item":"https://opensource.adobe.com/react-spectrum-charts/PR-596-docs/docs/Developer-Docs"}]}</script><link rel="stylesheet" href="/react-spectrum-charts/PR-596-docs/assets/css/styles.36fd3d91.css">
<script src="/react-spectrum-charts/PR-596-docs/assets/js/runtime~main.040960a2.js" defer="defer"></script>
<script src="/react-spectrum-charts/PR-596-docs/assets/js/main.7f571444.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_G6ar" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/react-spectrum-charts/PR-596-docs/"><div class="navbar__logo"><img src="/react-spectrum-charts/PR-596-docs/img/logo.svg" alt="React Spectrum Charts Logo" class="themedComponent_DHUr themedComponent--light_DIHH"><img src="/react-spectrum-charts/PR-596-docs/img/logo.svg" alt="React Spectrum Charts Logo" class="themedComponent_DHUr themedComponent--dark_Bv2M"></div><b class="navbar__title text--truncate">React Spectrum Charts</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/react-spectrum-charts/PR-596-docs/docs/intro">Documentation</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/adobe/react-spectrum-charts" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_OLSw colorModeToggle_Hg9V"><button class="clean-btn toggleButton_wYmb toggleButtonDisabled_vaDU" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_KEbZ lightToggleIcon_Sxwe"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_KEbZ darkToggleIcon_Yem1"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_KEbZ systemToggleIcon_txm5"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_bmvg"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_UyTV"><div class="docsWrapper_XLvK"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_z1FD" type="button"></button><div class="docRoot_HciC"><aside class="theme-doc-sidebar-container docSidebarContainer_e5ai"><div class="sidebarViewport_N8x0"><div class="sidebar_vJCc"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_qiME"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/react-spectrum-charts/PR-596-docs/docs/intro">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/react-spectrum-charts/PR-596-docs/docs/guides/chart-basics">Guides</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/react-spectrum-charts/PR-596-docs/docs/api/Chart">API Reference</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/react-spectrum-charts/PR-596-docs/docs/api/Chart">Chart</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" tabindex="0" href="/react-spectrum-charts/PR-596-docs/docs/api/visualizations/Area">Core Visualizations</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/react-spectrum-charts/PR-596-docs/docs/api/visualizations/Area">Area</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/react-spectrum-charts/PR-596-docs/docs/api/visualizations/Bar">Bar</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/react-spectrum-charts/PR-596-docs/docs/api/visualizations/BigNumber">BigNumber</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/react-spectrum-charts/PR-596-docs/docs/api/visualizations/Donut">Donut</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/react-spectrum-charts/PR-596-docs/docs/api/visualizations/Line">Line</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/react-spectrum-charts/PR-596-docs/docs/api/visualizations/Scatter">Scatter</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/react-spectrum-charts/PR-596-docs/docs/api/analysis/MetricRange">Analysis</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/react-spectrum-charts/PR-596-docs/docs/api/components/Axis">Chart Components</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/react-spectrum-charts/PR-596-docs/docs/api/interactivity/ChartTooltip">Interactivity</a></div></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/react-spectrum-charts/PR-596-docs/docs/Developer-Docs">Developer Docs</a></li></ul></nav></div></div></aside><main class="docMainContainer_namt"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_YAwJ"><div class="docItemContainer_Rv5Z"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_zCmv" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/react-spectrum-charts/PR-596-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_JFrk"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Developer Docs</span></li></ul></nav><div class="tocCollapsible_O_Qc theme-doc-toc-mobile tocMobile_tjDr"><button type="button" class="clean-btn tocCollapsibleButton_htYj">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Developer Docs</h1></header>
<h2 class="anchor anchorWithStickyNavbar_fF9Z" id="what-is-react-spectrum-charts">What is <code>react-spectrum-charts</code>?<a href="#what-is-react-spectrum-charts" class="hash-link" aria-label="Direct link to what-is-react-spectrum-charts" title="Direct link to what-is-react-spectrum-charts">​</a></h2>
<p><code>react-spectrum-charts</code> is a react visualization library built on <a href="https://vega.github.io/vega/" target="_blank" rel="noopener noreferrer">Vega</a>. <code>react-spectrum-charts</code> uses a declarative approach to convert react components and properties into a spectrum-styled vega visualization (Chart: <code>(data) =&gt; spectrum visualization</code>).</p>
<h2 class="anchor anchorWithStickyNavbar_fF9Z" id="how-it-works">How it works<a href="#how-it-works" class="hash-link" aria-label="Direct link to How it works" title="Direct link to How it works">​</a></h2>
<p>At its simplest, the Chart component is a single react component that takes in props and uses those to render a vega visualization.</p>
<p>&quot;Single react component you say? What about Bar, Axis, Legend etc?&quot;</p>
<p>I&#x27;m glad you asked! Technically all the react components that you can pass into the Chart component as children don&#x27;t render any react components. Instead, these are just a cleaner way of defining more complicated props for Chart.</p>
<p>We could just have a single component for creating a bar chart like so:</p>
<div class="language-jsx codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-jsx codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">Chart</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">stacked-bar</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">data</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript" style="color:#00009f">data</span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">orientation</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">horizontal</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">axis</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">bottom</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><br></span></code></pre></div></div>
<p>This could work but it would get very cumbersome very quick as the complexity of the chart increases. For example, let&#x27;s say you wanted to have a line and a bar on the same chart. Does this mean we also need a <code>type=&quot;combo&quot;</code>? Or what if we want a line that has an area chart behind it showing the standard deviation?</p>
<p>Another downside of this method is the props become ambiguous or require really long verbose names to describe what they do. <code>orientation</code> is a great example of this. What is this referring to? Is this how the bar should be oriented, or where the legend should be?</p>
<p>Another option would be to accept a spec JSON object that defines all the desired properties of the visualization like <a href="https://vega.github.io/vega-lite/" target="_blank" rel="noopener noreferrer">Vega-lite</a>. But we can do better than this...</p>
<h3 class="anchor anchorWithStickyNavbar_fF9Z" id="collection-component">Collection Component<a href="#collection-component" class="hash-link" aria-label="Direct link to Collection Component" title="Direct link to Collection Component">​</a></h3>
<p>A more elegant solution is for Chart to be a <a href="https://react-spectrum.adobe.com/react-stately/collections.html" target="_blank" rel="noopener noreferrer">collection component</a>. A collection component accepts both props and react components as children (which are also technically props).</p>
<p>Back to our bar example, by using Chart as a collection component, we get the following:</p>
<div class="language-jsx codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-jsx codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">Chart</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">data</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript" style="color:#00009f">data</span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">Axis</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">position</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">bottom</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">Bar</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">orientation</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">horizontal</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag class-name" style="color:#00009f">Chart</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre></div></div>
<p>Building our visualization this way makes it far more readable and more composable. For example, what if we revisit the complex example above where we have a line plot with an area behind it to represent the standard deviation. Also to complicate things further, lets add a 7 day moving average to the line?</p>
<div class="language-jsx codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-jsx codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">Chart</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">data</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript" style="color:#00009f">data</span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">Area</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">metricStart</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value" style="color:#e3116c">lowerBound</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">metricEnd</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value" style="color:#e3116c">upperBound</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">opacity</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript number" style="color:#36acaa">0.2</span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">Line</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">metric</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">mean</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">trendline</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">moving-7</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag class-name" style="color:#00009f">Chart</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre></div></div>
<p>Now we are talking. You can see that with Chart as a collection component, we get highly configurable visualizations with minimal code that is still very readable. Win, win, win.</p>
<h3 class="anchor anchorWithStickyNavbar_fF9Z" id="pseudo-components">Pseudo Components<a href="#pseudo-components" class="hash-link" aria-label="Direct link to Pseudo Components" title="Direct link to Pseudo Components">​</a></h3>
<p>Ultimately, all chart visualizations get converted to a vega spec. A vega spec is a complex JSON object that defines the visualization. This means that even though child components like <code>Axis</code> and <code>Bar</code> can be passed into Chart, there aren&#x27;t any actual <code>Axis</code> or <code>Bar</code> components that get rendered to the DOM.</p>
<p>Instead, these child components are treated as complex props that get represented in the final vega spec that gets rendered by Chart. Since the child components of Chart do not actually get rendered, these are referred to as &quot;Pseudo Components&quot;.</p>
<p>&quot;If it&#x27;s not a real React component, how do I create a pseudo component in the library?&quot;</p>
<p>It&#x27;s really simple. This is the Bar component from <code>Bar.tsx</code> file:</p>
<div class="language-tsx codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-tsx codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">BarProps</span><span class="token imports"> </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;../types&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Bar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> dimension </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;category&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> color </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;series&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> metric </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;value&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> opacity </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">BarProps</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>You can see that <code>Bar</code> follows the pascal-case naming convention of a react component. It also accepts a props object as an input just like any other react component. In this example you can see that we spread the props and define all defaults. This is not required but is recommended since it allows storybook to pick up the available props and all the default values automatically.</p>
<p>&quot;Cool but... this feels hacky.&quot;</p>
<p>This may seem hacky at first glance but this pattern is common practice in libraries. For example, this is exactly how react-spectrum handles children of collection components like TableView and Menu (<a href="https://github.com/adobe/react-spectrum/blob/main/packages/%40react-stately/table/src/TableHeader.ts#L17-L19" target="_blank" rel="noopener noreferrer">TableHeader</a> example).</p>
<p>&quot;Well if the child components are just pseudo components, then what&#x27;s real?&quot;</p>
<p>Great questions. Introducing the spec builder.</p>
<h3 class="anchor anchorWithStickyNavbar_fF9Z" id="spec-builder">Spec Builder<a href="#spec-builder" class="hash-link" aria-label="Direct link to Spec Builder" title="Direct link to Spec Builder">​</a></h3>
<p>The Chart takes all the props, children and the children&#x27;s props and uses those to compose a valid vega spec. The spec builder is what does this.</p>
<p>The spec builder uses the functional programming pattern. This was chosen for predictability and testability.</p>
<h4 class="anchor anchorWithStickyNavbar_fF9Z" id="predictability">Predictability<a href="#predictability" class="hash-link" aria-label="Direct link to Predictability" title="Direct link to Predictability">​</a></h4>
<p>Functional programming doesn&#x27;t allow side effects. Since Chart is simply building a spec file and using it to display a vega visualization, there isn&#x27;t a need for side effects.</p>
<h4 class="anchor anchorWithStickyNavbar_fF9Z" id="testability">Testability<a href="#testability" class="hash-link" aria-label="Direct link to Testability" title="Direct link to Testability">​</a></h4>
<p>The final output of Chart is a vega visualization. This means integration and end-to-end testing isn&#x27;t always trivial. This increases the need for strong unit testing which functional programming excels at.</p>
<h4 class="anchor anchorWithStickyNavbar_fF9Z" id="decoupled-children">Decoupled Children<a href="#decoupled-children" class="hash-link" aria-label="Direct link to Decoupled Children" title="Direct link to Decoupled Children">​</a></h4>
<p>To keep Chart extensible and easy to develop in. The child components are used to build the final spec independently of one another, keeping them decoupled. For example, <code>addBar()</code> only accepts the initial state of the spec and bar props as inputs. For some controlled behavior, we may pass in some props from the Chart, but none of the Axis props or other component props are accessible from within <code>addBar()</code>.</p>
<div class="language-tsx codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-tsx codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token plain">spec </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain">children</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">sort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> buildOrder</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">type</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> buildOrder</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">b</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">type</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">reduce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">acc</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Spec</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cur</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> type </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cur</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">type</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">type</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Axis&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">addAxis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">acc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cur </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token maybe-class-name">AxisElement</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">props</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Bar&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">addBar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">acc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cur </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token maybe-class-name">BarElement</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">props</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Line&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">addLine</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">acc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cur </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token maybe-class-name">LineElement</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">props</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Legend&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">addLegend</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">acc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cur </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token maybe-class-name">LegendElement</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">props</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">default</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;invalid type&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> acc</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> spec</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_fF9Z" id="best-practices">Best Practices<a href="#best-practices" class="hash-link" aria-label="Direct link to Best Practices" title="Direct link to Best Practices">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_fF9Z" id="functional-programming">Functional Programming<a href="#functional-programming" class="hash-link" aria-label="Direct link to Functional Programming" title="Direct link to Functional Programming">​</a></h3>
<p>The spec builder implements a functional programming pattern. This means that functions must be immutable and cannot have any side effects.</p>
<h4 class="anchor anchorWithStickyNavbar_fF9Z" id="setters">Setters<a href="#setters" class="hash-link" aria-label="Direct link to Setters" title="Direct link to Setters">​</a></h4>
<p>A setter is a pure function that takes in an initial state and some arguments and returns a new modified copy of the initial state based on the arguments. Setters should match this pattern:</p>
<div class="language-tsx codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-tsx codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> set</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token maybe-class-name">Property</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">T</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">(initState: T, args: Args): T =&gt; </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> stateCopy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain">initState</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// stateCopy.property = arg;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> stateCopy</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>Notice that the initial state gets copied and then the copy gets modified. This is because we have to maintain immutability.</p>
<p>One tricky thing is even though we are spreading the initState to create a copy, this doesn&#x27;t create a deep copy of the original. So if we need to edit deeply nested properties, that will also modify the original state and we are no longer immutable!</p>
<p>An easy fix for this is to use <a href="https://immerjs.github.io/immer/" target="_blank" rel="noopener noreferrer">immer</a>. Here we wrap the function above in immer&#x27;s produce function. The inputs are <a href="https://immerjs.github.io/immer/curried-produce" target="_blank" rel="noopener noreferrer">curried</a> to our function:</p>
<div class="language-tsx codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-tsx codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports">produce</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;immer&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> set</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token maybe-class-name">Property</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token generic-function function" style="color:#d73a49">produce</span><span class="token generic-function generic class-name operator" style="color:#393A34">&lt;</span><span class="token generic-function generic class-name constant" style="color:#36acaa">T</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">,</span><span class="token generic-function generic class-name"> </span><span class="token generic-function generic class-name punctuation" style="color:#393A34">[</span><span class="token generic-function generic class-name">Args</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">]</span><span class="token generic-function generic class-name operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">initState</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// initState.property = arg;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> initState</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p>Notice that we don&#x27;t need to copy the initState anymore. We can write normal mutable code and still maintain immutability. Immer outlines the recommended <a href="https://immerjs.github.io/immer/update-patterns" target="_blank" rel="noopener noreferrer">update patterns</a> and common <a href="https://immerjs.github.io/immer/pitfalls" target="_blank" rel="noopener noreferrer">pitfalls</a> in their documentation. Please follow these recommendations and avoid the pitfalls outlined.</p>
<h4 class="anchor anchorWithStickyNavbar_fF9Z" id="getters">Getters<a href="#getters" class="hash-link" aria-label="Direct link to Getters" title="Direct link to Getters">​</a></h4>
<p>A getter is a pure function that takes in some arguments and returns a value. Unlike setters, getters don&#x27;t require an initial state. There also isn&#x27;t any need to wrap getters in immer because they shouldn&#x27;t be implementing any code that would mutate an object regardless of immer.</p>
<p>Example:</p>
<div class="language-tsx codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-tsx codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getTooltip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">children</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">DialogElement</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">ProductionRule</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">StringValueRef</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">undefined</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">children</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		</span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> signal</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;datum&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_fF9Z" id="decoupled-child-components">Decoupled Child Components<a href="#decoupled-child-components" class="hash-link" aria-label="Direct link to Decoupled Child Components" title="Direct link to Decoupled Child Components">​</a></h3>
<p>Each of the child components of Chart (ex. Bar, Line, Legend etc.) should be kept independent of one another. In practice, this means, when calling <code>addBar()</code>, the only arguments allowed are the initial state and bar props. We don&#x27;t want to pass in any of the props from Legend or Chart to <code>addBar()</code>.</p>
<p>Sometimes one child will have some functionality that impacts another child. A great example of this is Legend. Legend supports a <code>highlight</code> prop. If true, when the user hovers over a legend item, the corresponding series will be highlighted in the chart (typically by lowering the opacity of all other series).</p>
<p>So how do we keep Legend decoupled from Bar and Line. The way we do this is by building the spec in a specific order. By making sure that Bar and Line get added to the spec before Legend, the <code>addLegend()</code> setter can traverse the <code>spec.marks</code> looking for any marks that should be highlighted and modify those marks directly in the spec. This keeps the two independent of one another but still allows us to support properties that affect multiple components.</p>
<p>It is very important to keep the children decoupled because it keeps the code base easy to work in and prevents it from turning into spaghetti. It&#x27;s also critical for keeping Chart highly composable.</p>
<h2 class="anchor anchorWithStickyNavbar_fF9Z" id="common-dev-workflow">Common Dev Workflow<a href="#common-dev-workflow" class="hash-link" aria-label="Direct link to Common Dev Workflow" title="Direct link to Common Dev Workflow">​</a></h2>
<p>With any new <code>react-spectrum-charts</code> request, the following workflow is typically followed. Some steps may be skipped depending on how simple the request is.</p>
<p>As an example for this workflow, we will go through the process of enhancing the legend symbols to default to rounded squares instead of circles (the vega default).</p>
<h3 class="anchor anchorWithStickyNavbar_fF9Z" id="review-the-vega-documentation">Review the Vega documentation<a href="#review-the-vega-documentation" class="hash-link" aria-label="Direct link to Review the Vega documentation" title="Direct link to Review the Vega documentation">​</a></h3>
<p>Since <code>react-spectrum-charts</code> builds all the charts in vega, typically the first step in a new feature request is figuring out how to implement the feature request in vega. The best resource for learning how to implements something is the <a href="https://vega.github.io/vega/docs/" target="_blank" rel="noopener noreferrer">vega documentation</a>.</p>
<p>Another good resource is to look through the <a href="https://vega.github.io/vega/examples/" target="_blank" rel="noopener noreferrer">vega examples</a> for a solution that is close to the desired feature request. Each example has the full spec that can be reviewed. Each example also has a link that will open the example in the <a href="https://vega.github.io/editor/#/edited" target="_blank" rel="noopener noreferrer">vega editor</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_fF9Z" id="try-implementing-the-feature-in-the-vega-editor">Try implementing the feature in the vega editor<a href="#try-implementing-the-feature-in-the-vega-editor" class="hash-link" aria-label="Direct link to Try implementing the feature in the vega editor" title="Direct link to Try implementing the feature in the vega editor">​</a></h3>
<p>The <a href="https://vega.github.io/editor/#/edited" target="_blank" rel="noopener noreferrer">vega editor</a> is a live playground that allows you to try out altering a vega spec and observing the result. It is typically a good practice to find an example that is close to desired feature request, open that in vega editor and then attempt to modify it to implement the feature.</p>
<p>It is highly recommended to take the time to fully understand each property in the spec. There are often multiple ways to accomplish the same thing in vega, so take the time to understand them so the best solution can be implemented in <code>react-spectrum-charts</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_fF9Z" id="modify-a-react-spectrum-charts-spec-in-the-vega-editor">Modify a <code>react-spectrum-charts</code> spec in the vega editor<a href="#modify-a-react-spectrum-charts-spec-in-the-vega-editor" class="hash-link" aria-label="Direct link to modify-a-react-spectrum-charts-spec-in-the-vega-editor" title="Direct link to modify-a-react-spectrum-charts-spec-in-the-vega-editor">​</a></h3>
<p>Now that the correct way to implement the desired feature has been identified, it is often helpful to pull in a <code>react-spectrum-charts</code> vega spec and attempt to implement the feature.</p>
<p>Note that <code>react-spectrum-charts</code> uses a config option to override many of the vega defaults. This means that what is displayed in the vega editor will not match one-to-one with what displays in storybook. Config options are strictly cosmetic so they should have minimal impact.</p>
<h4 class="anchor anchorWithStickyNavbar_fF9Z" id="how-to-pull-a-react-spectrum-charts-generated-vega-spec-into-the-vega-editor">How to pull a <code>react-spectrum-charts</code> generated vega spec into the vega editor<a href="#how-to-pull-a-react-spectrum-charts-generated-vega-spec-into-the-vega-editor" class="hash-link" aria-label="Direct link to how-to-pull-a-react-spectrum-charts-generated-vega-spec-into-the-vega-editor" title="Direct link to how-to-pull-a-react-spectrum-charts-generated-vega-spec-into-the-vega-editor">​</a></h4>
<ol>
<li>Find or write a story that can be a starting point for implementing this feature</li>
<li>On the story, add the <code>debug</code> property to the <code>Chart</code> component<!-- -->
<div class="language-jsx codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-jsx codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">Chart</span><span class="token tag" style="color:#00009f"> </span><span class="token tag spread punctuation" style="color:#393A34">{</span><span class="token tag spread operator" style="color:#393A34">...</span><span class="token tag spread" style="color:#00009f">chartProps</span><span class="token tag spread punctuation" style="color:#393A34">}</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">debug</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre></div></div>
</li>
<li>Start storybook by running <code>yarn storybook</code></li>
<li>In storybook, open the console in the dev tools</li>
<li>Open the story that was modified in storybook</li>
<li>The spec for that story will be printed to the console</li>
<li>Copy the entire spec and paste it into the <a href="https://vega.github.io/editor/#/edited" target="_blank" rel="noopener noreferrer">vega editor</a></li>
<li>Add the following to the top of the spec<!-- -->
<div class="language-json codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-json codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token property" style="color:#36acaa">&quot;width&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">600</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token property" style="color:#36acaa">&quot;height&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">600</span><span class="token punctuation" style="color:#393A34">,</span><br></span></code></pre></div></div>
</li>
<li>The <code>react-spectrum-charts</code> generated spec should be displaying in the vega editor now.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_fF9Z" id="implement-in-chart">Implement in Chart<a href="#implement-in-chart" class="hash-link" aria-label="Direct link to Implement in Chart" title="Direct link to Implement in Chart">​</a></h3>
<p>Now that the spec changes required to add the desired feature are identified, time to try it on the real thing. For this step, please follow all of the best practices called out above (or the PR will not be approved).</p>
<p>It&#x27;s typically best to dev using storybook.</p>
<p>Please make sure code is well commented so that others will understand why the feature was implemented the way that it was.</p>
<h3 class="anchor anchorWithStickyNavbar_fF9Z" id="update-test-and-write-new-tests">Update test and write new tests<a href="#update-test-and-write-new-tests" class="hash-link" aria-label="Direct link to Update test and write new tests" title="Direct link to Update test and write new tests">​</a></h3>
<p>Now that the feature is working and all is right in the world, make sure that the new code is adequately tested. <code>react-spectrum-charts</code> requires 60% code coverage for all new lines of code. Typically if the coverage is not &gt;90%, the PR will not be approved.</p>
<p>To verify that all existing test still pass, run either <code>yarn test</code> or <code>yarn watch</code>. It&#x27;s also possible to pass in a regex to run a subset of tests (<code>yarn watch legendSpecBuilder.test</code>). Without a regex, all tests will be run.</p>
<h3 class="anchor anchorWithStickyNavbar_fF9Z" id="submit-a-pr">Submit a PR<a href="#submit-a-pr" class="hash-link" aria-label="Direct link to Submit a PR" title="Direct link to Submit a PR">​</a></h3>
<p>Now that the new feature is implemented and tested, it&#x27;s time to submit a PR.</p>
<h2 class="anchor anchorWithStickyNavbar_fF9Z" id="linking-your-local-react-spectrum-charts-package-to-another-local-package">Linking your local react-spectrum-charts package to another local package.<a href="#linking-your-local-react-spectrum-charts-package-to-another-local-package" class="hash-link" aria-label="Direct link to Linking your local react-spectrum-charts package to another local package." title="Direct link to Linking your local react-spectrum-charts package to another local package.">​</a></h2>
<p>There are a number of ways to do this. Yarn link is a common solution. Here are the steps to link using <a href="https://github.com/wclr/yalc" target="_blank" rel="noopener noreferrer">yalc</a>:</p>
<ol>
<li>Install yalc globally. <code>yarn global add yalc</code></li>
<li>In the react-spectrum-charts project directory, run <code>yalc publish</code>.</li>
<li>In the project that you would like to run the local version of react-spectrum-charts in, run <code>yalc add</code> with the react-spectrum-charts package name.</li>
<li>When you make changes in react-spectrum-charts, run <code>yalc publish</code> in the react-spectrum-charts directory. Then, run <code>yalc update</code> in your project directory.</li>
</ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/adobe/react-spectrum-charts/tree/main/packages/docs/docs/Developer-Docs.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_UohW" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_g62E"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/react-spectrum-charts/PR-596-docs/docs/api/interactivity/ChartPopover"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">ChartPopover</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_TN1Q thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-is-react-spectrum-charts" class="table-of-contents__link toc-highlight">What is <code>react-spectrum-charts</code>?</a></li><li><a href="#how-it-works" class="table-of-contents__link toc-highlight">How it works</a><ul><li><a href="#collection-component" class="table-of-contents__link toc-highlight">Collection Component</a></li><li><a href="#pseudo-components" class="table-of-contents__link toc-highlight">Pseudo Components</a></li><li><a href="#spec-builder" class="table-of-contents__link toc-highlight">Spec Builder</a></li></ul></li><li><a href="#best-practices" class="table-of-contents__link toc-highlight">Best Practices</a><ul><li><a href="#functional-programming" class="table-of-contents__link toc-highlight">Functional Programming</a></li><li><a href="#decoupled-child-components" class="table-of-contents__link toc-highlight">Decoupled Child Components</a></li></ul></li><li><a href="#common-dev-workflow" class="table-of-contents__link toc-highlight">Common Dev Workflow</a><ul><li><a href="#review-the-vega-documentation" class="table-of-contents__link toc-highlight">Review the Vega documentation</a></li><li><a href="#try-implementing-the-feature-in-the-vega-editor" class="table-of-contents__link toc-highlight">Try implementing the feature in the vega editor</a></li><li><a href="#modify-a-react-spectrum-charts-spec-in-the-vega-editor" class="table-of-contents__link toc-highlight">Modify a <code>react-spectrum-charts</code> spec in the vega editor</a></li><li><a href="#implement-in-chart" class="table-of-contents__link toc-highlight">Implement in Chart</a></li><li><a href="#update-test-and-write-new-tests" class="table-of-contents__link toc-highlight">Update test and write new tests</a></li><li><a href="#submit-a-pr" class="table-of-contents__link toc-highlight">Submit a PR</a></li></ul></li><li><a href="#linking-your-local-react-spectrum-charts-package-to-another-local-package" class="table-of-contents__link toc-highlight">Linking your local react-spectrum-charts package to another local package.</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/react-spectrum-charts/PR-596-docs/docs/intro">Getting Started</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/adobe/react-spectrum-charts/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Discussions<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/react-spectrum-charts" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/adobe/react-spectrum-charts" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Adobe. / <a href="https://www.adobe.com/privacy.html">Privacy</a> / <a href="https://www.adobe.com/legal/terms.html">Terms of Use</a> / <a href="https://www.adobe.com/privacy/cookies.html">Cookies</a> / <a href="https://www.adobe.com/privacy/ca-rights.html">Do Not Sell My Personal Information</a></div></div></div></footer></div>
</body>
</html>